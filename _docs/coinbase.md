# Coinbase

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

Manages the coinbase data download and processing. It is important to
note that the Coinbase API might change from time to time, and the
functions might need to be updated. You can find the documentation here:
https://docs.cdp.coinbase.com/exchange/reference/exchangerestapi_getproductcandles.

Notice also that there are limits of what one can download. See the
documentation for more details. In particular:
https://docs.cdp.coinbase.com/exchange/docs/rest-rate-limits

\*\* Finally, datetime columns are in UTC. \*\*

------------------------------------------------------------------------

<a
href="https://github.com/silvaac/token_style/blob/main/token_style/coinbase.py#L16"
target="_blank" style="float:right; font-size:smaller">source</a>

### retrieve_coinbase_price

>      retrieve_coinbase_price (pair='BTC-USD', time_interval=3600,
>                               end_date='2025-01-21T11:48:20Z',
>                               start_date='2025-01-19T11:48:20Z')

\*Retrieves historical price data from Coinbase for a given trading pair
and time interval.

Makes a GET request to the Coinbase candles endpoint to fetch OHLCV
(Open, High, Low, Close, Volume) data for the specified trading pair and
time period.

Args: pair (str, optional): Trading pair symbol (e.g. “BTC-USD”).
Defaults to “BTC-USD”. time_interval (int, optional): Candle interval in
seconds. Defaults to 3600 (1 hour). end_date (str, optional): End
datetime in ISO 8601 format. Defaults to current UTC time. start_date
(str, optional): Start datetime in ISO 8601 format. Defaults to 2 days
before end_date.

Returns: pandas.DataFrame: DataFrame containing the OHLCV data with
columns: - datetime: Timestamp for the candle (UTC) - low: Lowest traded
price in the interval - high: Highest traded price in the interval  
- open: Opening price of the interval - close: Closing price of the
interval - volume: Trading volume in the interval - pair: Trading pair
symbol Returns None if the API request fails or returns no data.

Notes: - Limited to 300 requests per hour by the Coinbase API - Maximum
of 200 candles can be retrieved per request - Attempting to exceed these
limits will result in an error and return None - All datetime values are
in UTC timezone\*

------------------------------------------------------------------------

<a
href="https://github.com/silvaac/token_style/blob/main/token_style/coinbase.py#L68"
target="_blank" style="float:right; font-size:smaller">source</a>

### coinbase_tokens

>      coinbase_tokens ()

\*Retrieves all available trading pairs from the Coinbase Exchange API.

Makes a GET request to the Coinbase products endpoint to fetch
information about all trading pairs available on the exchange.

Returns: pandas.DataFrame: DataFrame containing information about all
trading pairs with columns: - id: Trading pair ID (e.g. ‘BTC-USD’) -
base_currency: The cryptocurrency being traded (e.g. ‘BTC’) -
quote_currency: The currency used for pricing (e.g. ‘USD’) -
quote_increment: Minimum price increment - base_increment: Minimum
quantity increment - display_name: Human readable name of the trading
pair - status: Trading status of the pair And other metadata columns
provided by the Coinbase API\*

------------------------------------------------------------------------

<a
href="https://github.com/silvaac/token_style/blob/main/token_style/coinbase.py#L93"
target="_blank" style="float:right; font-size:smaller">source</a>

### coinbase_usd_tokens

>      coinbase_usd_tokens ()

\*Retrieves all trading pairs from Coinbase that have USD as the quote
currency.

Returns: pandas.DataFrame: DataFrame containing information about USD
trading pairs with columns: - id: Trading pair ID (e.g. ‘BTC-USD’) -
base_currency: The cryptocurrency being traded (e.g. ‘BTC’) -
quote_currency: Always ‘USD’ for this filtered dataset -
quote_increment: Minimum price increment - base_increment: Minimum
quantity increment - display_name: Human readable name of the trading
pair - status: Trading status of the pair And other metadata columns
provided by the Coinbase API\*

------------------------------------------------------------------------

<a
href="https://github.com/silvaac/token_style/blob/main/token_style/coinbase.py#L113"
target="_blank" style="float:right; font-size:smaller">source</a>

### coinbase_price_history

>      coinbase_price_history (pair='BTC-USD', start_date='2024-01-01',
>                              end_date='2024-05-01', time_interval=3600,
>                              max_pull=250, verbose=False)

\*Downloads historical price data for a cryptocurrency pair from
Coinbase, handling rate limits.

Args: pair (str): Trading pair symbol (e.g. ‘BTC-USD’). Defaults to
‘BTC-USD’. start_date (str): Start date in ‘YYYY-MM-DD’ format. Defaults
to ‘2024-01-01’. end_date (str): End date in ‘YYYY-MM-DD’ format.
Defaults to ‘2024-05-01’. time_interval (int): Time interval between
candles in seconds. Defaults to 3600 (1 hour). max_pull (int): Maximum
number of candles per API request. Defaults to 250. verbose (bool): If
True, prints progress messages. Defaults to False.

Returns: pandas.DataFrame: DataFrame containing price history with
columns: - datetime: Timestamp of the candle - low: Lowest price during
the interval - high: Highest price during the interval  
- open: Opening price of the interval - close: Closing price of the
interval - volume: Trading volume during the interval - pair: Trading
pair symbol

Raises: ValueError: If end_date is earlier than start_date

The function handles Coinbase’s API limitations by automatically
splitting requests into smaller chunks if the date range would exceed
the maximum allowed candles per request.\*

------------------------------------------------------------------------

<a
href="https://github.com/silvaac/token_style/blob/main/token_style/coinbase.py#L174"
target="_blank" style="float:right; font-size:smaller">source</a>

### save_file

>      save_file (df, folder_path, file_name, type='csv')

\*Save a pandas DataFrame to a file in either CSV or Parquet format.

Args: df (pandas.DataFrame): The DataFrame to save folder_path (str):
Directory path where the file will be saved file_name (str): Name of the
file without extension type (str, optional): File format - either “csv”
or “parquet”. Defaults to “csv”

The function saves the DataFrame to the specified path, handling the
file extension automatically. For CSV files, the index is not saved. For
Parquet files, default Parquet settings are used.\*

------------------------------------------------------------------------

<a
href="https://github.com/silvaac/token_style/blob/main/token_style/coinbase.py#L195"
target="_blank" style="float:right; font-size:smaller">source</a>

### coinbase_to_file

>      coinbase_to_file (folder_path='../data/coinbase', token_list=['WAMPL-
>                        USD', 'BLZ-USD', 'WAXL-USD', 'SPA-USD', 'PEPE-USD',
>                        'MCO2-USD', 'RBN-USD', 'AUCTION-USD', 'KAVA-USD', 'XTZ-
>                        USD', 'JTO-USD', 'SUI-USD', 'PRO-USD', 'AIOZ-USD',
>                        'DNT-USD', 'RENDER-USD', 'KEEP-USD', 'SYLO-USD', 'PRCL-
>                        USD', 'CHZ-USD', 'CELR-USD', 'CVC-USD', 'CTSI-USD',
>                        'C98-USD', 'MPL-USD', 'SUSHI-USD', 'DEXT-USD', 'G-USD',
>                        'FORTH-USD', 'SHDW-USD', 'ICP-USD', 'MANA-USD', 'ALGO-
>                        USD', 'POLY-USD', 'DOGE-USD', 'FIL-USD', 'JUP-USD',
>                        'MXC-USD', 'DRIFT-USD', 'PLA-USD', 'AXS-USD', 'NMR-
>                        USD', 'HIGH-USD', 'INV-USD', 'NU-USD', 'RGT-USD', 'VGX-
>                        USD', 'MOG-USD', 'BUSD-USD', 'GNO-USD', 'METIS-USD',
>                        'ELA-USD', 'HOPR-USD', 'PUNDIX-USD', 'STX-USD',
>                        'BIGTIME-USD', 'WCFG-USD', 'SNX-USD', 'LDO-USD',
>                        'MEDIA-USD', 'OSMO-USD', 'LRDS-USD', 'WIF-USD', 'MATH-
>                        USD', 'BLUR-USD', 'T-USD', 'RAD-USD', 'WBTC-USD', 'XRP-
>                        USD', 'EURC-USD', 'MIR-USD', 'MOODENG-USD', 'IMX-USD',
>                        'BICO-USD', 'RONIN-USD', 'KSM-USD', 'AUDIO-USD', 'GTC-
>                        USD', 'ALEPH-USD', 'PYR-USD', 'KRL-USD', 'BTC-USD',
>                        'DEGEN-USD', 'FET-USD', 'CRPT-USD', 'ZRO-USD', 'ORCA-
>                        USD', 'ZETA-USD', 'AVT-USD', 'MSOL-USD', 'RNDR-USD',
>                        'SWELL-USD', 'ENJ-USD', 'JASMY-USD', 'ANKR-USD', 'IDEX-
>                        USD', 'BAND-USD', 'VELO-USD', 'XLM-USD', 'UPI-USD',
>                        'ETH-USD', 'SPELL-USD', 'GST-USD', 'GALA-USD', 'OP-
>                        USD', 'PERP-USD', 'SEI-USD', 'ZEC-USD', 'INDEX-USD',
>                        'AVAX-USD', 'DASH-USD', 'AMP-USD', 'FLR-USD', 'REP-
>                        USD', 'OMG-USD', 'WELL-USD', 'LCX-USD', 'AKT-USD',
>                        'BOND-USD', 'AGLD-USD', 'ACX-USD', 'PYUSD-USD',
>                        'BADGER-USD', 'POWR-USD', 'OGN-USD', 'ARKM-USD', 'SYN-
>                        USD', 'UNFI-USD', 'LPT-USD', 'DAI-USD', 'CORECHAIN-
>                        USD', 'IO-USD', 'GRT-USD', 'YFII-USD', 'GHST-USD',
>                        'AXL-USD', 'MDT-USD', 'CLV-USD', 'TIA-USD', 'FX-USD',
>                        'ONDO-USD', 'HNT-USD', 'YFI-USD', 'MTL-USD', 'SWFTC-
>                        USD', 'MUSE-USD', 'DYP-USD', 'BCH-USD', 'ROSE-USD',
>                        'ERN-USD', 'BLAST-USD', 'ASM-USD', 'SKL-USD', 'ALEO-
>                        USD', 'LRC-USD', 'SAFE-USD', 'MINA-USD', 'APT-USD',
>                        'LQTY-USD', 'DOT-USD', 'MONA-USD', 'QNT-USD', 'CVX-
>                        USD', 'TIME-USD', 'POLS-USD', 'NKN-USD', 'POND-USD',
>                        'LOKA-USD', 'ANT-USD', 'DIA-USD', 'COVAL-USD', 'GODS-
>                        USD', 'DDX-USD', 'ADA-USD', 'HFT-USD', 'RPL-USD',
>                        'STRK-USD', 'TRB-USD', 'ATOM-USD', 'ORN-USD', 'AURORA-
>                        USD', 'EOS-USD', 'GLM-USD', 'LINK-USD', 'LTC-USD',
>                        'MOVE-USD', 'PRIME-USD', 'VET-USD', 'GIGA-USD', 'COMP-
>                        USD', 'AAVE-USD', 'BAT-USD', 'SAND-USD', 'REN-USD',
>                        'API3-USD', 'EGLD-USD', 'DIMO-USD', 'DAR-USD', 'SHPING-
>                        USD', 'MASK-USD', 'TVK-USD', 'DREP-USD', 'MLN-USD',
>                        'MOBILE-USD', 'MAGIC-USD', 'OMNI-USD', 'COW-USD',
>                        'ZETACHAIN-USD', 'XCN-USD', 'CTX-USD', 'FARM-USD',
>                        'DESO-USD', 'ZEN-USD', 'XYO-USD', 'CBETH-USD', 'SUPER-
>                        USD', 'BAL-USD', 'APE-USD', 'NEST-USD', 'AERGO-USD',
>                        'ALICE-USD', 'ACH-USD', 'AERO-USD', 'NEAR-USD', 'ATA-
>                        USD', 'IOTX-USD', 'BONK-USD', 'SD-USD', 'NEON-USD',
>                        'RLC-USD', 'GAL-USD', 'MATIC-USD', 'PNUT-USD', 'GMT-
>                        USD', 'PLU-USD', 'TRU-USD', 'GFI-USD', 'TRUMP-USD',
>                        'A8-USD', '1INCH-USD', 'QUICK-USD', 'AST-USD', 'ETC-
>                        USD', 'PAX-USD', 'ILV-USD', 'TRIBE-USD', 'MULTI-USD',
>                        'LSETH-USD', 'WLUNA-USD', 'NCT-USD', 'FLOKI-USD',
>                        'FORT-USD', 'OCEAN-USD', 'RLY-USD', 'PNG-USD', 'REQ-
>                        USD', 'TONE-USD', 'PIRATE-USD', 'INJ-USD', '00-USD',
>                        'ACS-USD', 'RARI-USD', 'CRO-USD', 'ZRX-USD', 'GUSD-
>                        USD', 'TNSR-USD', 'BNT-USD', 'BTRST-USD', 'ENS-USD',
>                        'UST-USD', 'OOKI-USD', 'BOBA-USD', 'RAI-USD', 'FIDA-
>                        USD', 'TRAC-USD', 'MKR-USD', 'RARE-USD', 'BIT-USD',
>                        'FIS-USD', 'ARB-USD', 'KNC-USD', 'HBAR-USD', 'PRQ-USD',
>                        'SNT-USD', 'SOL-USD', 'QI-USD', 'CRV-USD', 'ME-USD',
>                        'LOOM-USD', 'ARPA-USD', 'OXT-USD', 'CGLD-USD', 'USDT-
>                        USD', 'ABT-USD', 'KARRAT-USD', 'ALCX-USD', 'QSP-USD',
>                        'STG-USD', 'UMA-USD', 'POL-USD', 'FOX-USD', 'COTI-USD',
>                        'SUKU-USD', 'SHIB-USD', 'VTHO-USD', 'TURBO-USD', 'UNI-
>                        USD', 'ZK-USD', 'LIT-USD', 'STORJ-USD', 'EIGEN-USD',
>                        'SEAM-USD', 'HONEY-USD', 'GYEN-USD', 'VARA-USD', 'FLOW-
>                        USD', 'MNDE-USD', 'MUSD-USD', 'VOXEL-USD'], type='csv',
>                        interval=3600, all_tokens=True, refresh_24h=False)

\*Downloads and maintains historical price data for Coinbase tokens,
saving to files.

Args: folder_path (str): Path where token data files will be stored.
Defaults to “../data/coinbase” token_list (list): List of token IDs to
process. Defaults to all USD trading pairs from coinbase_usd_tokens()
type (str): File format to save data - either “csv” or “parquet”.
Defaults to “csv” interval (int): Time interval in seconds between price
points. Defaults to 3600 (1 hour) all_tokens (bool): If True, includes
any additional tokens found in the folder path. Defaults to True
refresh_24h (bool): If True, replaces at least 24 hours. Defaults to
False

The function: - Creates the folder_path if it doesn’t exist - Date/Time
is UTC - For each token, checks if data file exists: - If exists: Loads
file and appends any new data since last recorded date - If not exists:
Downloads full history starting from 2016 - Saves data in specified
format, handling duplicates and sorting by date - For hourly data
(interval=3600), aligns to hour boundaries\*

------------------------------------------------------------------------

<a
href="https://github.com/silvaac/token_style/blob/main/token_style/coinbase.py#L269"
target="_blank" style="float:right; font-size:smaller">source</a>

### coinbase_data_update

>      coinbase_data_update (folder_path='../data/coinbase', token='AAVE-USD',
>                            type='parquet', interval=3600, refresh_24h=True)

\*Downloads new historical price data for Coinbase tokens… no saving

Args: folder_path (str): Path where token data files will be stored.
Defaults to “../data/coinbase” token (str): token IDs to process type
(str): File format to save data - either “csv” or “parquet”. Defaults to
“parquet” interval (int): Time interval in seconds between price points.
Defaults to 3600 (1 hour) refresh_24h (bool): If True, replaces at least
24 hours. Defaults to True

Returns: df (pandas.DataFrame): DataFrame of historical price data

The function: - Date/Time is UTC - For each token, checks if data file
exists: - If exists: Loads file and appends any new data since last
recorded date - If not exists: Downloads full history starting from
2016 - For hourly data (interval=3600), aligns to hour boundaries\*

------------------------------------------------------------------------

<a
href="https://github.com/silvaac/token_style/blob/main/token_style/coinbase.py#L334"
target="_blank" style="float:right; font-size:smaller">source</a>

### read_all_files

>      read_all_files (folder_path='../data/coinbase', type='csv')

\*Read and combine all files from a folder into a single DataFrame.

Args: folder_path (str): Path to the folder containing the files.
Defaults to “../data/coinbase”. type (str): File type to read - either
“csv” or “parquet”. Defaults to “csv”.

Returns: pandas.DataFrame: Combined DataFrame containing data from all
files in the folder.

Raises: ValueError: If file type is not supported (must be “csv” or
“parquet”).\*

------------------------------------------------------------------------

<a
href="https://github.com/silvaac/token_style/blob/main/token_style/coinbase.py#L362"
target="_blank" style="float:right; font-size:smaller">source</a>

### coinbase_price_last_day

>      coinbase_price_last_day (pair='BTC-USD')

\*Fetch the last day’s price for a given Coinbase token. This fuction is
a helper function around coinbase_price_history().

Args: pair (str): Coinbase token pair, e.g., “BTC-USD”. Defaults to
“BTC-USD”.

Returns: pandas dataframe: Last 24 hours price data.\*

------------------------------------------------------------------------

<a
href="https://github.com/silvaac/token_style/blob/main/token_style/coinbase.py#L381"
target="_blank" style="float:right; font-size:smaller">source</a>

### binance_format

>      binance_format (df)

\*Convert coinbase dataframe to binance format.

Args: df (pandas dataframe): Coinbase dataframe.

Returns: pandas dataframe: Binance format dataframe.\*

## Examples

Load the package

``` python
from token_style.coinbase import *
```

### List the available tokens on Coinbase

List the available tokens on Coinbase.

``` python
tokens = coinbase_tokens()
print(tokens)
```

                id base_currency quote_currency quote_increment base_increment  \
    0      APE-EUR           APE            EUR           0.001           0.01   
    1      MKR-USD           MKR            USD            0.01       0.000001   
    2      XLM-BTC           XLM            BTC      0.00000001              1   
    3     USDC-GBP          USDC            GBP          0.0001           0.01   
    4    ARPA-USDT          ARPA           USDT          0.0001            0.1   
    ..         ...           ...            ...             ...            ...   
    653    ICP-EUR           ICP            EUR           0.001         0.0001   
    654  EURC-USDC          EURC           USDC          0.0001              1   
    655    LRC-BTC           LRC            BTC      0.00000001              1   
    656   VARA-USD          VARA            USD         0.00001              1   
    657   DIA-USDT           DIA           USDT         0.00001           0.01   

        display_name min_market_funds  margin_enabled  post_only  limit_only  \
    0        APE-EUR                1           False      False       False   
    1        MKR-USD                1           False      False       False   
    2        XLM-BTC         0.000016           False      False       False   
    3       USDC-GBP             0.72           False      False        True   
    4      ARPA-USDT                1           False      False       False   
    ..           ...              ...             ...        ...         ...   
    653      ICP-EUR             0.84           False      False       False   
    654    EURC/USDC                1           False      False        True   
    655      LRC-BTC         0.000016           False      False       False   
    656     VARA-USD                1           False      False       False   
    657     DIA-USDT                1           False      False       False   

         cancel_only    status status_message  trading_disabled  fx_stablecoin  \
    0          False    online                            False          False   
    1          False    online                            False          False   
    2          False    online                            False          False   
    3          False    online                            False           True   
    4          False  delisted                             True          False   
    ..           ...       ...            ...               ...            ...   
    653        False    online                            False          False   
    654        False    online                            False           True   
    655        False    online                            False          False   
    656        False    online                            False          False   
    657        False  delisted                             True          False   

        max_slippage_percentage  auction_mode high_bid_limit_percentage  
    0                0.03000000         False                            
    1                0.03000000         False                            
    2                0.03000000         False                            
    3                0.01000000         False                0.03000000  
    4                0.03000000         False                            
    ..                      ...           ...                       ...  
    653              0.03000000         False                            
    654              0.01000000         False                0.03000000  
    655              0.03000000         False                            
    656              0.03000000         False                            
    657              0.03000000         False                            

    [658 rows x 18 columns]

To make it simpler, we can filter the tokens by the quote currency. In
this case, we filter for USD.

``` python
usd_tokens = coinbase_usd_tokens()
print(usd_tokens)
```

                 id base_currency quote_currency quote_increment base_increment  \
    1       MKR-USD           MKR            USD            0.01       0.000001   
    7      OSMO-USD          OSMO            USD          0.0001           0.01   
    8       HNT-USD           HNT            USD           0.001           0.01   
    9       RAI-USD           RAI            USD            0.01           0.01   
    10      VET-USD           VET            USD         0.00001              1   
    ..          ...           ...            ...             ...            ...   
    647     OGN-USD           OGN            USD         0.00001           0.01   
    649      OP-USD            OP            USD           0.001           0.01   
    650  BADGER-USD        BADGER            USD            0.01          0.001   
    651    PEPE-USD          PEPE            USD      0.00000001              1   
    656    VARA-USD          VARA            USD         0.00001              1   

        display_name min_market_funds  margin_enabled  post_only  limit_only  \
    1        MKR-USD                1           False      False       False   
    7       OSMO-USD                1           False      False       False   
    8        HNT-USD                1           False      False       False   
    9        RAI-USD                1           False      False       False   
    10       VET-USD                1           False      False       False   
    ..           ...              ...             ...        ...         ...   
    647      OGN-USD                1           False      False       False   
    649       OP-USD                1           False      False       False   
    650   BADGER-USD                1           False      False       False   
    651     PEPE/USD                1           False      False       False   
    656     VARA-USD                1           False      False       False   

         cancel_only    status status_message  trading_disabled  fx_stablecoin  \
    1          False    online                            False          False   
    7          False    online                            False          False   
    8          False    online                            False          False   
    9          False  delisted                             True          False   
    10         False    online                            False          False   
    ..           ...       ...            ...               ...            ...   
    647        False    online                            False          False   
    649        False    online                            False          False   
    650        False    online                            False          False   
    651        False    online                            False          False   
    656        False    online                            False          False   

        max_slippage_percentage  auction_mode high_bid_limit_percentage  
    1                0.03000000         False                            
    7                0.03000000         False                            
    8                0.03000000         False                            
    9                0.03000000         False                            
    10               0.03000000         False                            
    ..                      ...           ...                       ...  
    647              0.03000000         False                            
    649              0.03000000         False                            
    650              0.03000000         False                            
    651              0.03000000         False                            
    656              0.03000000         False                            

    [319 rows x 18 columns]

### Data pull examples

Download the historical price of BTC-USD for few months at every hour.
IMPORTANT: datetime is in UTC!

``` python
df = coinbase_price_history()
print(df)
```

                    datetime       low      high      open     close       volume  \
    0    2024-01-01 00:00:00  42261.58  42543.64  42288.58  42452.66   379.197253   
    1    2024-01-01 01:00:00  42415.00  42749.99  42453.83  42594.68   396.201924   
    2    2024-01-01 02:00:00  42488.03  42625.68  42594.58  42571.32   227.141166   
    3    2024-01-01 03:00:00  42235.00  42581.26  42571.32  42325.11   306.005694   
    4    2024-01-01 04:00:00  42200.00  42393.48  42325.10  42389.77   296.233644   
    ...                  ...       ...       ...       ...       ...          ...   
    2900 2024-04-30 20:00:00  59087.36  60082.82  59098.18  59869.99  1655.908771   
    2901 2024-04-30 21:00:00  59862.17  60326.56  59865.66  60100.36   615.103455   
    2902 2024-04-30 22:00:00  60070.00  60990.48  60100.01  60526.64   727.224395   
    2903 2024-04-30 23:00:00  60330.92  60878.39  60529.65  60622.10   346.354179   
    2904 2024-05-01 00:00:00  60015.99  60785.49  60621.20  60173.03   499.935743   

             pair  
    0     BTC-USD  
    1     BTC-USD  
    2     BTC-USD  
    3     BTC-USD  
    4     BTC-USD  
    ...       ...  
    2900  BTC-USD  
    2901  BTC-USD  
    2902  BTC-USD  
    2903  BTC-USD  
    2904  BTC-USD  

    [2905 rows x 7 columns]

Download all history available in coinbase for the tokens saved in
folder “../data/coinbase” This process can take a while specially if you
are downloading many tokens the first time.

Full download with no files in the folder takes almost 5 hours. After
that, it is much faster (~ 6 minutes). Clearly it will depend on your
internet speed and the last time you did the download.

``` python
coinbase_to_file(type="parquet") # takes almost 5 hours if there no files in the folder!
```

Now read the file from folder “../data/coinbase”:

``` python
import pandas as pd
df = pd.read_parquet("../data/coinbase/AAVE-USD.parquet")
print(df)
```

                     datetime      low     high     open    close    volume  \
    0     2020-12-15 17:00:00   87.700   90.400   90.400   88.347  4289.548   
    1     2020-12-15 18:00:00   85.620   88.407   88.010   86.000  3802.529   
    2     2020-12-15 19:00:00   84.575   89.500   86.105   85.952  2835.124   
    3     2020-12-15 20:00:00   84.828   85.952   85.952   85.599   798.670   
    4     2020-12-15 21:00:00   84.744   85.893   85.599   85.208   442.464   
    ...                   ...      ...      ...      ...      ...       ...   
    35942 2025-01-21 12:00:00  357.540  371.480  362.100  366.670  8248.061   
    35943 2025-01-21 13:00:00  359.410  367.930  366.650  365.500  6770.685   
    35944 2025-01-21 14:00:00  358.290  366.990  365.610  359.610  5676.846   
    35945 2025-01-21 15:00:00  354.590  362.880  359.510  357.290  5677.313   
    35946 2025-01-21 16:00:00  354.870  362.290  357.310  357.700  4360.988   

               pair  
    0      AAVE-USD  
    1      AAVE-USD  
    2      AAVE-USD  
    3      AAVE-USD  
    4      AAVE-USD  
    ...         ...  
    35942  AAVE-USD  
    35943  AAVE-USD  
    35944  AAVE-USD  
    35945  AAVE-USD  
    35946  AAVE-USD  

    [35947 rows x 7 columns]

Read all files in the folder into a single dataframe:

``` python
df = read_all_files(type="parquet")
print(df)
```

                     datetime       low      high      open     close  \
    0     2022-10-11 17:00:00  0.372500  0.510000  0.450000  0.510000   
    1     2022-10-11 18:00:00  0.427800  1.284200  0.507800  1.284200   
    2     2022-10-11 19:00:00  0.900900  1.464600  1.269000  1.300000   
    3     2022-10-11 20:00:00  1.140000  1.382000  1.292100  1.331900   
    4     2022-10-11 21:00:00  1.268600  1.649800  1.331900  1.546400   
    ...                   ...       ...       ...       ...       ...   
    55011 2025-01-21 12:00:00  0.464885  0.474850  0.468067  0.471385   
    55012 2025-01-21 13:00:00  0.465000  0.473298  0.471186  0.468332   
    55013 2025-01-21 14:00:00  0.461907  0.473863  0.468567  0.463435   
    55014 2025-01-21 15:00:00  0.460000  0.467998  0.464733  0.466155   
    55015 2025-01-21 16:00:00  0.466431  0.478793  0.466431  0.474741   

                 volume     pair  
    0      2.214310e+05   00-USD  
    1      1.261266e+06   00-USD  
    2      1.587872e+06   00-USD  
    3      6.753579e+05   00-USD  
    4      8.359198e+05   00-USD  
    ...             ...      ...  
    55011  2.552343e+05  ZRX-USD  
    55012  3.205124e+04  ZRX-USD  
    55013  4.986324e+04  ZRX-USD  
    55014  5.256622e+04  ZRX-USD  
    55015  6.143745e+04  ZRX-USD  

    [6922279 rows x 7 columns]

Download the last day’s price for AAVE-USD:

``` python
# eval: false
coinbase_price_last_day(pair='AAVE-USD')
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&#10;    .dataframe tbody tr th {
        vertical-align: top;
    }
&#10;    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">datetime</th>
<th data-quarto-table-cell-role="th">low</th>
<th data-quarto-table-cell-role="th">high</th>
<th data-quarto-table-cell-role="th">open</th>
<th data-quarto-table-cell-role="th">close</th>
<th data-quarto-table-cell-role="th">volume</th>
<th data-quarto-table-cell-role="th">pair</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">23</td>
<td>2025-01-20 17:00:00</td>
<td>318.38</td>
<td>351.19</td>
<td>350.77</td>
<td>332.04</td>
<td>17009.535</td>
<td>AAVE-USD</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">22</td>
<td>2025-01-20 18:00:00</td>
<td>330.13</td>
<td>363.00</td>
<td>332.06</td>
<td>348.50</td>
<td>14342.571</td>
<td>AAVE-USD</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">21</td>
<td>2025-01-20 19:00:00</td>
<td>345.07</td>
<td>364.16</td>
<td>348.41</td>
<td>354.96</td>
<td>16268.851</td>
<td>AAVE-USD</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20</td>
<td>2025-01-20 20:00:00</td>
<td>348.00</td>
<td>355.80</td>
<td>354.95</td>
<td>348.55</td>
<td>5404.532</td>
<td>AAVE-USD</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">19</td>
<td>2025-01-20 21:00:00</td>
<td>340.42</td>
<td>352.36</td>
<td>348.39</td>
<td>341.27</td>
<td>5889.728</td>
<td>AAVE-USD</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">18</td>
<td>2025-01-20 22:00:00</td>
<td>337.83</td>
<td>348.73</td>
<td>341.27</td>
<td>348.57</td>
<td>3904.477</td>
<td>AAVE-USD</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17</td>
<td>2025-01-20 23:00:00</td>
<td>334.91</td>
<td>348.98</td>
<td>348.65</td>
<td>337.09</td>
<td>9045.903</td>
<td>AAVE-USD</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16</td>
<td>2025-01-21 00:00:00</td>
<td>327.27</td>
<td>339.04</td>
<td>337.07</td>
<td>327.87</td>
<td>9903.319</td>
<td>AAVE-USD</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15</td>
<td>2025-01-21 01:00:00</td>
<td>327.23</td>
<td>339.84</td>
<td>327.96</td>
<td>337.34</td>
<td>47457.843</td>
<td>AAVE-USD</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">14</td>
<td>2025-01-21 02:00:00</td>
<td>337.00</td>
<td>350.57</td>
<td>337.21</td>
<td>346.02</td>
<td>23115.761</td>
<td>AAVE-USD</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">13</td>
<td>2025-01-21 03:00:00</td>
<td>340.55</td>
<td>347.55</td>
<td>345.93</td>
<td>345.53</td>
<td>5440.116</td>
<td>AAVE-USD</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td>2025-01-21 04:00:00</td>
<td>332.82</td>
<td>345.80</td>
<td>345.80</td>
<td>340.28</td>
<td>4284.122</td>
<td>AAVE-USD</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">11</td>
<td>2025-01-21 05:00:00</td>
<td>332.54</td>
<td>341.14</td>
<td>340.24</td>
<td>336.69</td>
<td>3109.911</td>
<td>AAVE-USD</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>2025-01-21 06:00:00</td>
<td>334.67</td>
<td>344.57</td>
<td>336.69</td>
<td>342.67</td>
<td>4486.771</td>
<td>AAVE-USD</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>2025-01-21 07:00:00</td>
<td>339.26</td>
<td>344.16</td>
<td>342.49</td>
<td>341.09</td>
<td>3260.287</td>
<td>AAVE-USD</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>2025-01-21 08:00:00</td>
<td>337.90</td>
<td>344.62</td>
<td>341.05</td>
<td>343.19</td>
<td>3464.737</td>
<td>AAVE-USD</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>2025-01-21 09:00:00</td>
<td>342.07</td>
<td>355.21</td>
<td>342.78</td>
<td>355.21</td>
<td>7129.535</td>
<td>AAVE-USD</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>2025-01-21 10:00:00</td>
<td>349.29</td>
<td>369.55</td>
<td>354.95</td>
<td>365.87</td>
<td>15192.819</td>
<td>AAVE-USD</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>2025-01-21 11:00:00</td>
<td>357.10</td>
<td>369.21</td>
<td>365.93</td>
<td>362.00</td>
<td>6683.760</td>
<td>AAVE-USD</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>2025-01-21 12:00:00</td>
<td>357.54</td>
<td>371.48</td>
<td>362.10</td>
<td>366.67</td>
<td>8248.061</td>
<td>AAVE-USD</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>2025-01-21 13:00:00</td>
<td>359.41</td>
<td>367.93</td>
<td>366.65</td>
<td>365.50</td>
<td>6770.685</td>
<td>AAVE-USD</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>2025-01-21 14:00:00</td>
<td>358.29</td>
<td>366.99</td>
<td>365.61</td>
<td>359.61</td>
<td>5676.846</td>
<td>AAVE-USD</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>2025-01-21 15:00:00</td>
<td>354.59</td>
<td>362.88</td>
<td>359.51</td>
<td>357.29</td>
<td>5677.313</td>
<td>AAVE-USD</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>2025-01-21 16:00:00</td>
<td>354.87</td>
<td>362.29</td>
<td>357.31</td>
<td>358.40</td>
<td>4514.212</td>
<td>AAVE-USD</td>
</tr>
</tbody>
</table>

</div>

Update the data for AAVE-USD and convert it to Binance format (minor
changes in column names and sequence):

``` python
df = coinbase_data_update(token='BTC-USD')
binance_df = binance_format(df)
print(binance_df)
```

    Processing BTC-USD
                               date       Open       High        Low      Close  \
    0     2016-01-01 00:00:00+00:00     430.35     431.82     430.35     430.61   
    1     2016-01-01 01:00:00+00:00     430.59     430.98     430.00     430.78   
    2     2016-01-01 02:00:00+00:00     430.80     430.89     430.50     430.62   
    3     2016-01-01 03:00:00+00:00     430.62     432.84     430.31     432.84   
    4     2016-01-01 04:00:00+00:00     432.74     437.15     432.72     436.12   
    ...                         ...        ...        ...        ...        ...   
    79358 2025-01-21 12:00:00+00:00  103651.97  104631.99  103500.01  104405.22   
    79359 2025-01-21 13:00:00+00:00  104426.42  104894.98  104055.31  104370.76   
    79360 2025-01-21 14:00:00+00:00  104363.83  105236.04  102900.00  103178.25   
    79361 2025-01-21 15:00:00+00:00  103168.01  104016.75  102688.00  103854.59   
    79362 2025-01-21 16:00:00+00:00  103860.03  106500.00  103729.79  105195.47   

                Volume pair  
    0       160.179593  btc  
    1        92.132315  btc  
    2        93.024327  btc  
    3       103.811532  btc  
    4       363.875951  btc  
    ...            ...  ...  
    79358   490.800848  btc  
    79359   483.549109  btc  
    79360  1192.881482  btc  
    79361   968.173608  btc  
    79362  2133.184076  btc  

    [79363 rows x 7 columns]

``` python
import pandas as pd
df = coinbase_data_update(token = 'BTC-USD')
binance_df1 = binance_format(df)
df = coinbase_data_update(token = 'ETH-USD')
binance_df2 = binance_format(df)
dh = pd.concat([binance_df1, binance_df2])
#dh.to_feather("coinHist.fdr")
```

    Processing BTC-USD
    Processing ETH-USD
